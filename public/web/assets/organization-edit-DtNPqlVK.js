import{b3 as z,b4 as q,r as b,aF as D,a as R,c as $,o as h,w as t,b as a,aG as j,aH as A,u as n,aJ as G,aK as H,aL as J,aC as K,h as v,aB as L,m as N,U as y}from"./index-C4Wz-E93.js";import{a as S,E as P}from"./col-wGeLV9c2.js";import{E as Q}from"./input-number-tZCTFD7x.js";import{_ as W}from"./organization-select-DyZkA2vI.js";import{u as X,a as Y}from"./index-CiU_EHeO.js";const te={__name:"organization-edit",props:z({data:Object,organizationId:Number,organizationData:Array},{modelValue:{type:Boolean},modelModifiers:{}}),emits:z(["done"],["update:modelValue"]),setup(g,{emit:I}){const u=g,x=I,f=q(g,"modelValue"),m=b(!1),p=b(!1),_=b(null),[o,U,F]=D({organizationId:void 0,parentId:void 0,organizationName:"",organizationFullName:"",organizationCode:"",organizationType:void 0,sortNumber:void 0,comments:""}),E=R({organizationName:[{required:!0,message:"请输入机构名称",type:"string",trigger:"blur"}],organizationFullName:[{required:!0,message:"请输入机构全称",type:"string",trigger:"blur"}],organizationType:[{required:!0,message:"请选择机构类型",type:"string",trigger:"change"}],sortNumber:[{required:!0,message:"请输入排序号",type:"number",trigger:"blur"}]}),c=()=>{f.value=!1},C=()=>{var r,e;(e=(r=_.value)==null?void 0:r.validate)==null||e.call(r,i=>{if(!i)return;p.value=!0,(m.value?X:Y)({...o,parentId:o.parentId||0}).then(d=>{p.value=!1,N.success(d),c(),x("done")}).catch(d=>{p.value=!1,N.error(d.message)})})},w=()=>{u.data?(F({...u.data,parentId:u.data.parentId||void 0}),m.value=!0):(U(),o.parentId=u.organizationId,m.value=!1),y(()=>{y(()=>{var r,e;(e=(r=_.value)==null?void 0:r.clearValidate)==null||e.call(r)})})};return(r,e)=>{const i=G,s=H,d=P,O=J,T=Q,k=S,B=j,V=K,M=L;return h(),$(M,{form:"",width:620,modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value=l),title:m.value?"修改机构":"添加机构",onOpen:w},{footer:t(()=>[a(V,{onClick:c},{default:t(()=>e[9]||(e[9]=[v("取消")])),_:1}),a(V,{type:"primary",loading:p.value,onClick:C},{default:t(()=>e[10]||(e[10]=[v(" 保存 ")])),_:1},8,["loading"])]),default:t(()=>[a(B,{ref_key:"formRef",ref:_,model:n(o),rules:E,"label-width":"80px",onSubmit:e[7]||(e[7]=A(()=>{},["prevent"]))},{default:t(()=>[a(k,{gutter:16},{default:t(()=>[a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"上级机构",prop:"parentId"},{default:t(()=>[a(W,{modelValue:n(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>n(o).parentId=l),placeholder:"请选择上级机构","organization-data":g.organizationData},null,8,["modelValue","organization-data"])]),_:1}),a(i,{label:"机构名称",prop:"organizationName"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationName,"onUpdate:modelValue":e[1]||(e[1]=l=>n(o).organizationName=l),placeholder:"请输入机构名称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构全称",prop:"organizationFullName"},{default:t(()=>[a(s,{clearable:"",maxlength:100,modelValue:n(o).organizationFullName,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).organizationFullName=l),placeholder:"请输入机构全称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构代码"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationCode,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).organizationCode=l),placeholder:"请输入机构代码"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"机构类型",prop:"organizationType"},{default:t(()=>[a(O,{code:"organization_type",modelValue:n(o).organizationType,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).organizationType=l),placeholder:"请选择机构类型"},null,8,["modelValue"])]),_:1}),a(i,{label:"排序号",prop:"sortNumber"},{default:t(()=>[a(T,{min:0,max:99999,modelValue:n(o).sortNumber,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).sortNumber=l),placeholder:"请输入排序号","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),a(i,{label:"备注"},{default:t(()=>[a(s,{rows:3,type:"textarea",maxlength:200,modelValue:n(o).comments,"onUpdate:modelValue":e[6]||(e[6]=l=>n(o).comments=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};export{te as _};
