import{a$ as z,b0 as q,r as c,b1 as D,a as $,c as R,o as h,w as t,b as a,aI as j,aJ as A,u as n,aK as J,aM as K,cB as S,aD as G,h as v,aC as H,m as N,U as y}from"./index-D23Lrq5v.js";import{a as L,E as P}from"./col-xjoj90Kg.js";import{E as Q}from"./input-number-BF6sEwQK.js";import{_ as W}from"./organization-select-NfUdJ5Kn.js";import{u as X,a as Y}from"./index-SO5zHa4_.js";const te={__name:"organization-edit",props:z({data:Object,organizationId:Number,organizationData:Array},{modelValue:{type:Boolean},modelModifiers:{}}),emits:z(["done"],["update:modelValue"]),setup(g,{emit:I}){const u=g,x=I,f=q(g,"modelValue"),m=c(!1),p=c(!1),_=c(null),[o,U,E]=D({organizationId:void 0,parentId:void 0,organizationName:"",organizationFullName:"",organizationCode:"",organizationType:void 0,sortNumber:void 0,comments:""}),F=$({organizationName:[{required:!0,message:"请输入机构名称",type:"string",trigger:"blur"}],organizationFullName:[{required:!0,message:"请输入机构全称",type:"string",trigger:"blur"}],organizationType:[{required:!0,message:"请选择机构类型",type:"string",trigger:"change"}],sortNumber:[{required:!0,message:"请输入排序号",type:"number",trigger:"blur"}]}),b=()=>{f.value=!1},C=()=>{var r,e;(e=(r=_.value)==null?void 0:r.validate)==null||e.call(r,i=>{if(!i)return;p.value=!0,(m.value?X:Y)({...o,parentId:o.parentId||0}).then(d=>{p.value=!1,N.success(d),b(),x("done")}).catch(d=>{p.value=!1,N.error(d.message)})})},w=()=>{u.data?(E({...u.data,parentId:u.data.parentId||void 0}),m.value=!0):(U(),o.parentId=u.organizationId,m.value=!1),y(()=>{y(()=>{var r,e;(e=(r=_.value)==null?void 0:r.clearValidate)==null||e.call(r)})})};return(r,e)=>{const i=J,s=K,d=P,O=S,T=Q,k=L,M=j,V=G,B=H;return h(),R(B,{form:"",width:620,modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=l=>f.value=l),title:m.value?"修改机构":"添加机构",onOpen:w},{footer:t(()=>[a(V,{onClick:b},{default:t(()=>e[9]||(e[9]=[v("取消")])),_:1}),a(V,{type:"primary",loading:p.value,onClick:C},{default:t(()=>e[10]||(e[10]=[v(" 保存 ")])),_:1},8,["loading"])]),default:t(()=>[a(M,{ref_key:"formRef",ref:_,model:n(o),rules:F,"label-width":"80px",onSubmit:e[7]||(e[7]=A(()=>{},["prevent"]))},{default:t(()=>[a(k,{gutter:16},{default:t(()=>[a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"上级机构",prop:"parentId"},{default:t(()=>[a(W,{modelValue:n(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>n(o).parentId=l),placeholder:"请选择上级机构","organization-data":g.organizationData},null,8,["modelValue","organization-data"])]),_:1}),a(i,{label:"机构名称",prop:"organizationName"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationName,"onUpdate:modelValue":e[1]||(e[1]=l=>n(o).organizationName=l),placeholder:"请输入机构名称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构全称",prop:"organizationFullName"},{default:t(()=>[a(s,{clearable:"",maxlength:100,modelValue:n(o).organizationFullName,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).organizationFullName=l),placeholder:"请输入机构全称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构代码"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationCode,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).organizationCode=l),placeholder:"请输入机构代码"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"机构类型",prop:"organizationType"},{default:t(()=>[a(O,{code:"organization_type",modelValue:n(o).organizationType,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).organizationType=l),placeholder:"请选择机构类型"},null,8,["modelValue"])]),_:1}),a(i,{label:"排序号",prop:"sortNumber"},{default:t(()=>[a(T,{min:0,max:99999,modelValue:n(o).sortNumber,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).sortNumber=l),placeholder:"请输入排序号","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),a(i,{label:"备注"},{default:t(()=>[a(s,{rows:3,type:"textarea",maxlength:200,modelValue:n(o).comments,"onUpdate:modelValue":e[6]||(e[6]=l=>n(o).comments=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}};export{te as _};
